<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>360 PRO | Pulsologia Rápida</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root { --azul: #003366; --cinza: #f8f9fa; }
        body { background: var(--cinza); font-family: sans-serif; padding-bottom: 50px; }
        .card-clinico { background: white; border-radius: 15px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin: 10px auto; max-width: 500px; border-top: 6px solid var(--azul); }
        .etapa { display: none; }
        .ativa { display: block; }
        
        /* Grid de Pulsos */
        .grid-pulsos { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 15px; }
        .item-pulso { background: #fff; border: 1px solid #dee2e6; padding: 8px; border-radius: 10px; text-align: center; }
        .sigla { font-weight: bold; color: var(--azul); display: block; margin-bottom: 5px; font-size: 0.9rem; }
        
        .btn-group-sm .btn { padding: 2px 8px; font-size: 0.8rem; font-weight: bold; }
        .btn-check:checked + .btn-outline-danger { background-color: #dc3545; color: #fff; }
        .btn-check:checked + .btn-outline-success { background-color: #198754; color: #fff; }
        .btn-check:checked + .btn-outline-primary { background-color: #0d6efd; color: #fff; }

        .btn-pro { background: var(--azul); color: white; width: 100%; padding: 12px; border-radius: 10px; border: none; font-weight: bold; margin-top: 20px; }
    </style>
</head>
<body>

    <div id="p1" class="etapa ativa container mt-4">
        <div class="card-clinico text-center">
            <h4 class="fw-bold">MÉTODO 360 PRO</h4>
            <input type="text" id="pacienteId" class="form-control my-3" placeholder="ID do Paciente (Ex: MRO 5005)">
            <button class="btn-pro" onclick="ir(2)">AVALIAÇÃO BIO-PSÍQUICA</button>
        </div>
    </div>

    <div id="p2" class="etapa container mt-4">
        <div class="card-clinico">
            <h6 class="fw-bold">Ansiedade & Sono</h6>
            <label class="small">GAD-7 (0 a 3):</label>
            <select id="ans" class="form-select mb-3"><option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option></select>
            <label class="small">IGI (Sono):</label>
            <select id="sono" class="form-select"><option value="0">Bom</option><option value="1">Médio</option><option value="2">Ruim</option></select>
            <button class="btn-pro" onclick="ir(3)">PRÓXIMO: PULSOS</button>
        </div>
    </div>

    <div id="p3" class="etapa container mt-4">
        <div class="card-clinico">
            <h6 class="fw-bold mb-0">Exame dos 12 Pulsos</h6>
            <p class="text-muted" style="font-size: 0.7rem;">Marque (-) Vazio, (ok) Normal ou (+) Excesso</p>
            
            <div class="grid-pulsos" id="listaPulsos">
                </div>

            <button class="btn-pro" onclick="ir(4)">PRÓXIMO: LÍNGUA</button>
        </div>
    </div>

    <div id="p4" class="etapa container mt-4">
        <div class="card-p">
            <div class="card-clinico">
                <h6 class="fw-bold">Análise Visual</h6>
                <select id="cor" class="form-select mb-2"><option value="rosada">Rosada</option><option value="palida">Pálida</option><option value="vermelha">Vermelha</option></select>
                <select id="sab" class="form-select mb-3"><option value="fina">Saburra Fina</option><option value="grossa">Saburra Grossa</option></select>
                <button class="btn-pro" onclick="finalizar()">FINALIZAR E GERAR CONDUTA</button>
             </div>
        </div>
    </div>

    <div id="p5" class="etapa container mt-4">
        <div class="card-clinico" style="border-left-color: #198754;">
            <h5 class="fw-bold">Diagnóstico 360</h5>
            <div id="relatorio" class="small mt-3"></div>
            <div id="sugestao" class="p-2 mt-2 rounded" style="background:#fff3cd; font-size: 0.85rem;"></div>
            <button class="btn-pro" style="background:#25D366;" onclick="compartilhar()">ENVIAR PARA WHATSAPP</button>
        </div>
    </div>

    <script>
        const meridianos = ["P", "IG", "BP", "E", "C", "ID", "R", "B", "CS", "TA", "F", "VB"];
        
        // Criar os botões de pulso automaticamente
        const grid = document.getElementById('listaPulsos');
        meridianos.forEach(m => {
            grid.innerHTML += `
                <div class="item-pulso">
                    <span class="sigla">${m}</span>
                    <div class="btn-group btn-group-sm" role="group">
                        <input type="radio" class="btn-check" name="p_${m}" id="m_${m}_v" value="-" autocomplete="off">
                        <label class="btn btn-outline-danger" for="m_${m}_v">-</label>
                        
                        <input type="radio" class="btn-check" name="p_${m}" id="m_${m}_n" value="ok" autocomplete="off" checked>
                        <label class="btn btn-outline-primary" for="m_${m}_n">ok</label>
                        
                        <input type="radio" class="btn-check" name="p_${m}" id="m_${m}_e" value="+" autocomplete="off">
                        <label class="btn btn-outline-success" for="m_${m}_e">+</label>
                    </div>
                </div>`;
        });

        function ir(n) { document.querySelectorAll('.etapa').forEach(e => e.classList.remove('ativa')); document.getElementById('p' + n).classList.add('ativa'); window.scrollTo(0,0); }

        function finalizar() {
            let resumoPulsos = [];
            let taStatus = "ok";
            meridianos.forEach(m => {
                let val = document.querySelector(`input[name="p_${m}"]:checked`).value;
                if(val !== 'ok') resumoPulsos.push(`${m}${val}`);
                if(m === 'TA') taStatus = val;
            });

            const ans = document.getElementById('ans').value;
            const sab = document.getElementById('sab').value;
            let conduta = "<b>Conduta:</b> Harmonização dos meridianos afetados.";

            // Inteligência Clínica Simples
            if(taStatus === '-' || sab === 'grossa') {
                conduta = "<b>Estratégia:</b> Aquecer Yang e eliminar Humidade.<br><b>Pontos:</b> VC12, TA5, BP9.";
            }

            document.getElementById('relatorio').innerHTML = `
                <b>Paciente:</b> ${document.getElementById('pacienteId').value}<br>
                <b>Alterações:</b> ${resumoPulsos.join(', ') || 'Nenhuma'}<br>
                <b>Língua:</b> ${document.getElementById('cor').value} / ${sab}
            `;
            document.getElementById('sugestao').innerHTML = conduta;
            ir(5);
        }

        function compartilhar() {
            const txt = document.getElementById('relatorio').innerText + "\n" + document.getElementById('sugestao').innerText;
            window.open(`https://wa.me/?text=${encodeURIComponent(txt)}`);
        }
    </script>
</body>
</html>
